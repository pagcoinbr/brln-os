# BRLN-OS Atomic Swap Module - Environment Variables
# Copy this file to .env and update with your actual values

# ===== GENERAL SETTINGS =====
# Environment: development, staging, production
ENVIRONMENT=development

# Bitcoin network: mainnet, testnet, signet, regtest
BITCOIN_NETWORK=testnet

# Master password (inherited from BRLN-OS)
BRLN_MASTER_PASSWORD=your_master_password_here

# ===== DATABASE CONFIGURATION =====
# PostgreSQL connection
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=brln_swaps
POSTGRES_USER=brln_swap_user
POSTGRES_PASSWORD=changeme_in_production

# Database URL (automatically constructed if not set)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# For development with SQLite (fallback)
# DATABASE_URL=sqlite:////data/brln-swap/swaps.db

# ===== REDIS CONFIGURATION =====
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=changeme_redis_password
REDIS_DB=0

# Redis URL (automatically constructed if not set)
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# ===== LND CONFIGURATION =====
# LND gRPC connection
LND_HOST=localhost
LND_GRPC_PORT=10009
LND_REST_PORT=8080

# LND TLS certificate and macaroon paths
LND_TLS_CERT_PATH=/data/lnd/tls.cert
LND_MACAROON_PATH=/data/lnd/data/chain/bitcoin/${BITCOIN_NETWORK}/admin.macaroon

# ===== ELEMENTS/LIQUID CONFIGURATION =====
# Elements RPC connection
ELEMENTS_RPC_HOST=localhost
ELEMENTS_RPC_PORT=7041
ELEMENTS_RPC_USER=elements
ELEMENTS_RPC_PASSWORD=changeme_elements_password

# Elements data directory
ELEMENTS_DATA_DIR=/data/elements

# ===== TOR CONFIGURATION =====
# Tor SOCKS proxy
TOR_SOCKS_HOST=127.0.0.1
TOR_SOCKS_PORT=9050

# Tor control port (for creating hidden services)
TOR_CONTROL_HOST=127.0.0.1
TOR_CONTROL_PORT=9051
TOR_CONTROL_PASSWORD=changeme_tor_password

# This node's Tor hidden service address (will be auto-generated if not set)
# Format: abcdef1234567890.onion:9735
TOR_HIDDEN_SERVICE_ADDRESS=

# ===== P2P NETWORK CONFIGURATION =====
# P2P listening port (ZeroMQ)
P2P_LISTEN_PORT=9735

# Gossip protocol settings
GOSSIP_PROTOCOL_VERSION=1
GOSSIP_MAX_PEERS=50
GOSSIP_HEARTBEAT_INTERVAL=30

# Peer discovery bootstrap nodes (comma-separated Tor addresses)
# Example: abc123.onion:9735,def456.onion:9735
BOOTSTRAP_PEERS=

# ===== SWAP CONFIGURATION =====
# Default swap timeouts (in blocks)
BITCOIN_SWAP_TIMEOUT=144          # ~24 hours on Bitcoin
LIQUID_SWAP_TIMEOUT=288           # ~24 hours on Liquid (2.5x faster)

# Confirmation requirements (account for reorgs)
BITCOIN_MIN_CONFIRMATIONS=6
LIQUID_MIN_CONFIRMATIONS=2

# Maximum swap amount (satoshis) - safety limit for prototype
MAX_SWAP_AMOUNT_SATS=100000000    # 1 BTC

# Minimum swap amount (satoshis)
MIN_SWAP_AMOUNT_SATS=10000        # 10,000 sats

# ===== API CONFIGURATION =====
# API server settings
API_HOST=0.0.0.0
API_PORT=2122
API_DEBUG=false

# API authentication (session-based, inherited from BRLN-OS)
API_SESSION_TIMEOUT=300           # 5 minutes (in seconds)
API_SESSION_SECRET=changeme_very_long_random_secret_key_here

# API rate limiting
API_RATE_LIMIT_PER_MINUTE=60
API_RATE_LIMIT_PER_HOUR=1000

# ===== LOGGING CONFIGURATION =====
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format: json, text
LOG_FORMAT=json

# Log file path
LOG_FILE=/var/log/brln-swap/brln-swap.log

# ===== SECURITY SETTINGS =====
# Recovery file storage path (must have 0600 permissions)
RECOVERY_FILES_PATH=/data/brln-swap/recovery

# Encrypted backup path
BACKUP_PATH=/data/brln-swap/backups

# Enable encryption at rest for recovery files
ENCRYPT_RECOVERY_FILES=true

# ===== DEVELOPMENT/DEBUG SETTINGS =====
# Enable debug mode (NEVER use in production)
DEBUG=false

# Enable SQL query logging
SQL_ECHO=false

# Enable Tor (disable for local testing)
ENABLE_TOR=true

# Enable P2P network (disable for isolated testing)
ENABLE_P2P=true

# Testnet faucet URL (for development)
TESTNET_FAUCET_URL=https://testnet-faucet.mempool.co

# ===== MONITORING & ALERTS (optional) =====
# Prometheus metrics endpoint
ENABLE_METRICS=false
METRICS_PORT=9090

# Alert webhook URL (for critical errors)
ALERT_WEBHOOK_URL=

# ===== OPTIONAL SERVICES =====
# Celery (async task queue) configuration
# CELERY_BROKER_URL=${REDIS_URL}
# CELERY_RESULT_BACKEND=${REDIS_URL}

# Sentry (error tracking) - optional
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ===== FEATURE FLAGS (for gradual rollout) =====
FEATURE_SUBMARINE_SWAPS=true
FEATURE_LIQUID_SWAPS=true
FEATURE_PEER_DISCOVERY=true
FEATURE_AUTO_ACCEPT_SWAPS=false
